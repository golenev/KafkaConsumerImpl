# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–∏—Å–∞ Validator

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç Spring Boot —Å–µ—Ä–≤–∏—Å (`validator-service`), –∫–æ—Ç–æ—Ä—ã–π –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç
–≤—Ö–æ–¥—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è Kafka –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ç–æ–ø–∏–∫.
–ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω—ã —à–∞–≥–∏ –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∑–∞–ø—É—Å–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Kafka-–±—Ä–æ–∫–µ—Ä —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —É—Ç–∏–ª–∏—Ç–∞–º (`kafka-topics.sh`, `kafka-console-consumer.sh` –∏ —Ç.–ø.)
- JDK 21+
- Gradle Wrapper (–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
- –¢–µ—Ä–º–∏–Ω–∞–ª —Å Unix-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ (Bash)

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É Kafka

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Kafka-–±—Ä–æ–∫–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Spring-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
—Ç–æ–ø–∏–∫–∏ `in_validator` –∏ `out_validator` —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ Kafka Admin.
–£—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å, –ø–æ–¥ –∫–æ—Ç–æ—Ä–æ–π —Å–µ—Ä–≤–∏—Å –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∫–ª–∞—Å—Ç–µ—Ä—É, –¥–æ–ª–∂–Ω–∞ –æ–±–ª–∞–¥–∞—Ç—å
–ø—Ä–∞–≤–∞–º–∏ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–ø–∞—Ä–æ–ª—å –∏–ª–∏ –¥—Ä—É–≥–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

> üí° –ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –º–æ–∂–Ω–æ
> —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ø–∏–∫–∏ –≤—Ä—É—á–Ω—É—é –ª—é–±—ã–º –ø–æ–¥—Ö–æ–¥—è—â–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä,
> `kafka-topics.sh`). –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –Ω–µ –º–µ–Ω–µ–µ 3 –ø–∞—Ä—Ç–∏—Ü–∏–π –∏ —Ñ–∞–∫—Ç–æ—Ä
> —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–∞—à–µ–º—É –æ–∫—Ä—É–∂–µ–Ω–∏—é.

## 2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Kafka

–°–µ—Ä–≤–∏—Å —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Kafka –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω –ø—Ä–∏–º–µ—Ä –¥–ª—è
–ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –±—Ä–æ–∫–µ—Ä–∞ –±–µ–∑ SASL:

```bash
export VALIDATOR_KAFKA_BOOTSTRAP=localhost:9092
export VALIDATOR_KAFKA_SECURITY_PROTOCOL=PLAINTEXT
export VALIDATOR_KAFKA_SASL_MECHANISM=
export VALIDATOR_KAFKA_USERNAME=
export VALIDATOR_KAFKA_PASSWORD=
```

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥—Ä—É–≥–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ `validator.kafka.*`,
–Ω–∞–ø—Ä–∏–º–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä—ã consumer group –∏–ª–∏ —Å—Ç–µ–ø–µ–Ω—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.

## 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Spring Boot —Å–µ—Ä–≤–∏—Å

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Gradle Wrapper –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
./gradlew :validator-service:bootRun
```

–°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `http://localhost:8085`.

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∑–∞–ø—É—Å–∫ –∏–∑ JAR

```bash
./gradlew :validator-service:bootJar
java -jar validator-service/build/libs/validator-service-0.0.1-SNAPSHOT.jar
```

## 4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é

–û—Ç–ø—Ä–∞–≤—å—Ç–µ POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ REST-—ç–Ω–¥–ø–æ–∏–Ω—Ç —Å –ø–æ–º–æ—â—å—é –ª—é–±–æ–≥–æ HTTP-–∫–ª–∏–µ–Ω—Ç–∞. –ü—Ä–∏–º–µ—Ä —Å
`curl`:

```bash
curl -X POST http://localhost:8085/api/v1/validation \
  -H 'Content-Type: application/json' \
  -d '{
        "eventId": "evt-123",
        "userId": "42",
        "type_action": 100,
        "status": "PENDING",
        "sourceSystem": "demo",
        "priority": 5,
        "amount": 123.45
      }'
```

–ï—Å–ª–∏ `type_action == 100`, —Å–µ—Ä–≤–∏—Å –¥–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–º–µ—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
–≤ —Ç–æ–ø–∏–∫ `out_validator`. –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –æ–Ω –ø–∏—à–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –ª–æ–≥ –∏
–∑–∞–≤–µ—Ä—à–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É.

## 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ç–æ–ø–∏–∫–∞

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏ Kafka.
–ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ `out_validator`:

```bash
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic out_validator --from-beginning --max-messages 1
```

–õ–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ Kafka, –¥–æ—Å—Ç—É–ø–Ω—ã–π –≤ –≤–∞—à–µ–º
–æ–∫—Ä—É–∂–µ–Ω–∏–∏.

## 6. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Spring Boot –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ–º `Ctrl+C` (–µ—Å–ª–∏ –æ–Ω–æ –∑–∞–ø—É—â–µ–Ω–æ —á–µ—Ä–µ–∑
`bootRun`) –ª–∏–±–æ –∑–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å JAR. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ
Kafka-–±—Ä–æ–∫–µ—Ä —à—Ç–∞—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏.
